<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <template id="new_report">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="web.external_layout">
                    <style>
                        /* Typography */
                        .header-arabic {
                        text-align: right;
                        direction: rtl;
                        font-family: Arial;
                        font-size: 16px;
                        font-weight: bold;
                        }
                        .header-english {
                        text-align: left;
                        font-family: Arial;
                        font-size: 14px;
                        font-weight: bold;
                        }
                        .quotation-title {
                        text-align: center;
                        font-weight: bold;
                        font-size: 18px;
                        margin-top: 20px;
                        }
                        .project-name {
                        font-weight: bold;
                        margin: 10px 0;
                        }

                        /* Tables */
                        .table-details {
                        width: 100%;
                        border-collapse: collapse;
                        margin-bottom: 15px;
                        }
                        .table-details td {
                        padding: 3px;
                        vertical-align: top;
                        }
                        .item-table {
                        width: 100%;
                        border-collapse: collapse;
                        margin-top: 15px;
                        }
                        .item-table th, .item-table td {
                        border: 1px solid black;
                        padding: 5px;
                        }
                        .item-table th {
                        text-align: center;
                        font-weight: bold;
                        }
                        .item-table td {
                        text-align: left;
                        }
                        .item-table .number {
                        text-align: right;
                        }
                        .panel-header {
                        font-weight: bold;
                        background-color: #f2f2f2;
                        }

                        /* Lists and sections */
                        .terms-list {
                        margin-top: 15px;
                        padding-left: 20px;
                        }
                        .footer-section {
                        margin-top: 40px;
                        }
                        .signature-left {
                        float: left;
                        width: 45%;
                        }
                        .signature-right {
                        float: right;
                        width: 45%;
                        text-align: right;
                        }
                        .clearfix {
                        clear: both;
                        }

                        /* Component makes section */
                        .make-category {
                        font-weight: bold;
                        margin-top: 10px;
                        }
                        .make-description {
                        margin-left: 20px;
                        margin-bottom: 5px;
                        }

                        /* Spacing */
                        .section-margin {
                        margin-top: 20px;
                        }
                        .page-break {
                        page-break-after: always;
                        }
                    </style>

                    <!-- HEADER SECTION -->
                    <div class="quotation-title">QUOTATION</div>

                    <!-- CLIENT INFORMATION -->
                    <div>
                        <strong>Quoted to:</strong>
                    </div>
                    <div>
                        <strong>
                            <t t-esc="doc.partner_id.name"/>
                        </strong>
                    </div>

                    <!-- QUOTATION DETAILS -->
                    <table class="table-details">
                        <tr>
                            <td width="50%">
                                <table>
                                    <tr>
                                        <td>
                                            <strong>Quotation No.</strong>
                                        </td>
                                        <td>
                                            <t t-esc="doc.name"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <strong>Date</strong>
                                        </td>
                                        <td>
                                            <t t-esc="doc.date_order"/>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                            <td width="50%">
                                <table>
                                    <tr>
                                        <td>
                                            <strong>Tel:</strong>
                                        </td>
                                        <td>
                                            <t t-esc="doc.partner_id.phone"/>
                                        </td>
                                        <td>
                                            <strong>Inquiry No.</strong>
                                        </td>
                                        <td>
                                            <t t-esc="doc.inquiry_num"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <strong>Mob:</strong>
                                        </td>
                                        <td>
                                            <t t-esc="doc.partner_id.mobile"/>
                                        </td>
                                        <td>
                                            <strong>Inquiry Date</strong>
                                        </td>
                                        <td>
                                            <t t-esc="doc.date_order" t-options="{'widget': 'date'}"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <strong>Fax:</strong>
                                        </td>
                                        <td>
                                            <t t-esc="doc.partner_id.phone"/>
                                        </td>
                                        <td>
                                            <strong>Prepared by:</strong>
                                        </td>
                                        <td>
                                            <t t-esc="doc.prepared_by"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <strong>E-mail:</strong>
                                        </td>
                                        <td>
                                            <t t-esc="doc.partner_id.email"/>
                                        </td>
                                        <td>
                                            <strong>Inquiry No.</strong>
                                        </td>
                                        <td>
                                            <t t-esc="doc.inquiry_num"/>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>

                    <!-- PROJECT INFORMATION -->
                    <div>
                        <strong>Attention:</strong>
                    </div>
                    <div>
                        <strong>
                            <t t-esc="doc.attention"/>
                        </strong>
                    </div>

                    <div class="project-name">PROJECT NAME :</div>
                    <div>
                        <t t-esc="doc.project_name"/>
                    </div>

                    <!-- SALUTATION -->
                    <div class="section-margin">
                        <strong>Dear Sir:</strong>
                        <br/>
                        Reference to your inquiry as stated above, please find our offer as follows:
                    </div>

                    <!-- CATEGORY SUMMARY TABLE -->
                    <table class="item-table">
                        <thead>
                            <tr>
                                <th>S.NO.</th>
                                <th>Item's</th>
                                <th>QTY</th>
                                <th>Amount</th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-set="counter" t-value="1"/>
                            <t t-set="total_amount" t-value="0"/>
                            <t t-foreach="doc.get_category_summary()" t-as="category">
                                <tr>
                                    <td class="number">
                                        <t t-esc="counter"/>
                                    </td>
                                    <td>
                                        <t t-esc="category['name']"/>
                                        ---SET
                                    </td>
                                    <td class="number">
                                        <t t-esc="category['qty']"/>
                                    </td>
                                    <td class="number">
                                        <t t-esc="category['amount']"
                                           t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                    </td>
                                </tr>
                                <t t-set="counter" t-value="counter + 1"/>
                                <t t-set="total_amount" t-value="total_amount + category['amount']"/>
                            </t>

                            <!-- TOTALS SECTION -->
                            <tr>
                                <td colspan="2">
                                    Amount in words:
                                    <t t-esc="doc.currency_id.amount_to_text(doc.amount_total)"/>
                                </td>
                                <td>
                                    <strong>Gross Total:</strong>
                                </td>
                                <td class="number">
                                    <t t-esc="total_amount"
                                       t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                </td>
                            </tr>
                            <t t-if="doc.amount_untaxed != doc.amount_total">
                                <tr>
                                    <td colspan="3">
                                        <strong>Discount</strong>
                                    </td>
                                    <td class="number">
                                        <t t-esc="total_amount - doc.amount_total"
                                           t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                    </td>
                                </tr>
                            </t>
                            <tr>
                                <td colspan="3">
                                    <strong>Total Amount:</strong>
                                </td>
                                <td class="number">
                                    <t t-esc="doc.amount_total"
                                       t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- TERMS AND CONDITIONS -->
                    <div class="section-margin">
                        <strong>Terms and conditions:</strong>
                    </div>
                    <div>
                        <t t-esc="doc.note"/>
                    </div>

                    <!-- MAKE OF COMPONENTS -->
                    <div class="section-margin">
                        <strong>MAKE OF COMPONENTS:-</strong>
                    </div>
                    <div>L.V. Switchgear components : DORMAN SMITH</div>
                    <div>Enclosures : ADSF / AL FANAR</div>

                    <!-- COMPANY ADDRESS -->
                    <div class="section-margin">
                        Industrial City Abu Dhabi (ICAD)
                        <br/>
                        Mussafah,Abu Dhabi, U.A.E.
                        <br/>
                        P.O.Box: 70705 Abu Dhabi,U.A.E.
                    </div>

                    <!-- COMPONENT MAKES DETAILS -->
                    <div class="section-margin">
                        <strong>COMPONENT MAKES DETAILS:</strong>
                    </div>
                    <t t-set="category_makes_desc" t-value="doc.get_category_makes_with_descriptions()"/>
                    <t t-foreach="category_makes_desc.items()" t-as="category">
                        <t t-set="note_counter" t-value="1"/>
                        <div class="make-category">
                            <t t-esc="category[0]"/>:
                        </div>
                        <t t-foreach="category[1]" t-as="make">
                            <div class="make-description">
                                <span class="note-number"><t t-esc="note_counter"/>-
                                </span>
                                <t t-esc="make['description']"/>
                            </div>
                            <t t-set="note_counter" t-value="note_counter + 1"/>

                        </t>
                    </t>
                    <t t-if="not category_makes_desc">
                        <div class="make-category">L.V. Switchgear components:</div>
                        <div class="make-description">- DORMAN SMITH: High quality switchgear components</div>
                        <div class="make-category">Enclosures:</div>
                        <div class="make-description">- ADSF / AL FANAR: Premium quality enclosures</div>
                    </t>

                    <!-- PAGE BREAK -->
                    <div class="page-break"></div>

                    <!-- DETAILED PRODUCT TABLES BY CATEGORY -->
                    <t t-set="categories" t-value="doc.get_product_categories()"/>
                    <t t-foreach="categories.items()" t-as="category">
                        <table class="item-table section-margin">
                            <tr class="panel-header">
                                <td colspan="5">
                                    <t t-esc="category[0]"/>
                                </td>
                            </tr>
                            <tr>
                                <th>S.No.</th>
                                <th>Item Description</th>
                                <th>Qty</th>
                                <th>U/P</th>
                                <th>T/P</th>
                            </tr>
                            <t t-set="counter" t-value="1"/>
                            <t t-set="category_total" t-value="0"/>
                            <t t-foreach="category[1]" t-as="line">
                                <tr>
                                    <td class="number">
                                        <t t-esc="counter"/>
                                    </td>
                                    <td>
                                        <t t-esc="line.product_id.name"/>
                                    </td>
                                    <td class="number">
                                        <t t-esc="line.product_uom_qty"/>
                                    </td>
                                    <td class="number">
                                        <t t-esc="line.price_unit"
                                           t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                    </td>
                                    <td class="number">
                                        <t t-esc="line.price_subtotal"
                                           t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                    </td>
                                </tr>
                                <t t-set="counter" t-value="counter + 1"/>
                                <t t-set="category_total" t-value="category_total + line.price_subtotal"/>
                            </t>
                            <tr>
                                <td colspan="2">
                                    <strong>TOTAL</strong>
                                </td>
                                <td class="number">
                                    <t t-esc="len(category[1])"/>
                                </td>
                                <td></td>
                                <td class="number">
                                    <t t-esc="category_total"
                                       t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                </td>
                            </tr>
                        </table>
                    </t>

                    <!-- SIGNATURE SECTION -->
                    <div class="section-margin">Thank You,</div>
                    <div>With Regards,</div>
                    <div>For Abu Dhabi Switchgear Factory LLC</div>

                    <!-- FINAL PAGE BREAK -->
                    <div class="page-break"></div>
                </t>
            </t>
        </t>
    </template>
    <template id="new_report_technical_report">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="web.external_layout">
                    <style>
                        /* Capacitor Bank Table Styling - Exact match to the image */
                        /* MDB Product Row Highlight */
                        .mdb-product-row {
                        background-color: #e6f2ff !important; /* Light blue background */
                        }
                        .mdb-product-row td {
                        font-weight: bold;
                        font-size: 1.1em; /* Slightly larger font */
                        border-top: 2px solid #4d94ff; /* Blue top border */
                        border-bottom: 2px solid #4d94ff; /* Blue bottom border */
                        }
                        .capacitor-table {
                        width: 100%;
                        border-collapse: collapse;
                        margin-top: 15px;
                        }
                        .capacitor-table th {
                        background-color: #808080;
                        color: white;
                        text-align: center;
                        padding: 5px;
                        font-weight: bold;
                        border: 1px solid #808080;
                        }
                        .capacitor-table .no-col {
                        width: 10%;
                        text-align: center;
                        }
                        .capacitor-table .desc-col {
                        width: 70%;
                        text-align: left;
                        padding-left: 10px;
                        }
                        .capacitor-table .qty-col {
                        width: 20%;
                        text-align: center;
                        }
                        .capacitor-table td {
                        padding: 5px;
                        border: 1px solid #d3d3d3;
                        }
                        .capacitor-table .product-row:nth-child(odd) {
                        background-color: #f2f2f2;
                        }
                        .capacitor-table .product-row:nth-child(even) {
                        background-color: #ffffff;
                        }
                        .capacitor-table .total-row {
                        background-color: #808080;
                        color: white;
                        font-weight: bold;
                        }
                        .capacitor-table .total-label {
                        text-align: center;
                        }
                        /* Typography */
                        body {
                        font-family: Arial, sans-serif;
                        font-size: 12px;
                        }
                        .quotation-title {
                        text-align: center;
                        font-weight: bold;
                        font-size: 16px;
                        margin: 20px 0;
                        }
                        .section-title {
                        font-weight: bold;
                        margin: 15px 0 5px 0;
                        }
                        .client-info {
                        margin-bottom: 10px;
                        }

                        /* Tables */
                        .info-table {
                        width: 100%;
                        border-collapse: collapse;
                        margin-bottom: 15px;
                        }
                        .info-table td {
                        padding: 3px;
                        border: 1px solid black;
                        }

                        /* Item Table - Matching the image design */
                        .item-table {
                        width: 100%;
                        border-collapse: collapse;
                        margin: 15px 0;
                        }
                        .item-table th, .item-table td {
                        border: 1px solid black;
                        padding: 5px;
                        }
                        .item-table th {
                        background-color: #f2f2f2;
                        text-align: center;
                        font-weight: bold;
                        }
                        .item-table td {
                        text-align: left;
                        }
                        .item-table .number-col {
                        width: 10%;
                        text-align: center;
                        }
                        .item-table .desc-col {
                        width: 70%;
                        text-align: center;
                        }
                        .item-table .qty-col {
                        width: 20%;
                        text-align: center;
                        }

                        /* Notes section */
                        .notes-section {
                        margin-top: 20px;
                        }
                        .note-item {
                        margin-bottom: 5px;
                        }

                        /* Signature section */
                        .signature-section {
                        margin-top: 40px;
                        }

                        /* Page break */
                        .page-break {
                        page-break-after: always;
                        }
                    </style>

                    <!-- HEADER SECTION -->
                    <div class="quotation-title">TECHNICAL OFFER</div>

                    <!-- CLIENT INFORMATION -->
                    <div class="client-info">
                        <strong>Quoted to:</strong>
                        <br/>
                        <strong>
                            <t t-esc="doc.partner_id.name"/>
                        </strong>
                        <br/>
                        <t t-if="doc.partner_id.country_id">
                            <t t-esc="doc.partner_id.country_id.name"/>
                        </t>
                    </div>

                    <!-- QUOTATION DETAILS -->
                    <table class="info-table">
                        <tr>
                            <td width="50%">
                                <strong>Quotation No.</strong>
                            </td>
                            <td width="50%">
                                <t t-esc="doc.name"/>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <strong>Date:</strong>
                            </td>
                            <td>
                                <t t-esc="doc.date_order" t-options="{'widget': 'date', 'format': 'dd-MMM-yy'}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <strong>Inquiry No.</strong>
                            </td>
                            <td>
                                <t t-esc="doc.inquiry_num"/>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <strong>Inquiry Date</strong>
                            </td>
                            <td>
                                <t t-esc="doc.date_order" t-options="{'widget': 'date', 'format': 'dd-MMM-yy'}"/>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <strong>Prepared by:</strong>
                            </td>
                            <td>
                                <t t-esc="doc.prepared_by"/>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <strong>Reference</strong>
                            </td>
                            <td></td>
                        </tr>
                    </table>

                    <!-- PROJECT INFORMATION -->
                    <div class="section-title">Project Name:</div>
                    <div>
                        <t t-esc="doc.project_name"/>
                    </div>

                    <div class="section-title">Attention:</div>
                    <div>
                        <t t-esc="doc.attention"/>
                    </div>

                    <!-- SALUTATION -->
                    <div class="section-title">Dear Sir:</div>
                    <div>Reference to your inquiry as stated above, please find our offer as follows:</div>

                    <!-- CATEGORY SUMMARY TABLE -->
                    <table class="item-table">
                        <thead>
                            <tr>
                                <th>S.NO.</th>
                                <th>Item's</th>
                                <th>QTY</th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-set="counter" t-value="1"/>
                            <t t-set="total_amount" t-value="0"/>
                            <t t-foreach="doc.get_category_summary()" t-as="category">
                                <tr>
                                    <td class="number">
                                        <t t-esc="counter"/>
                                    </td>
                                    <td>
                                        <t t-esc="category['name']"/>
                                        ---SET
                                    </td>
                                    <td class="number">
                                        <t t-esc="category['qty']"/>
                                    </td>
                                </tr>
                                <t t-set="counter" t-value="counter + 1"/>
                                <t t-set="total_amount" t-value="total_amount + category['amount']"/>
                            </t>

                        </tbody>
                    </table>

                    <!-- NOTES SECTION -->
                    <div class="section-title">NOTE</div>
                    <t t-set="category_makes_desc" t-value="doc.get_category_makes_with_descriptions()"/>
                    <t t-foreach="category_makes_desc.items()" t-as="category">
                        <t t-set="note_counter" t-value="1"/>

                        <div class="make-category">
                            <t t-esc="category[0]"/>:
                        </div>
                        <t t-foreach="category[1]" t-as="make">
                            <div class="make-description">
                                <span class="note-number"><t t-esc="note_counter"/>-
                                </span>
                                <t t-esc="make['description']"/>
                            </div>
                            <t t-set="note_counter" t-value="note_counter + 1"/>

                        </t>
                    </t>
                    <t t-if="not category_makes_desc">
                        <div class="make-category">L.V. Switchgear components:</div>
                        <div class="make-description">- DORMAN SMITH: High quality switchgear components</div>
                        <div class="make-category">Enclosures:</div>
                        <div class="make-description">- ADSF / AL FANAR: Premium quality enclosures</div>
                    </t>

                    <div class="page-break"></div>

                    <!-- CAPACITOR BANK TABLE (if needed on a separate page) -->
                    <!-- MDB TABLE SECTION -->
                    <div class="section-margin">
                        <strong>MAIN DISTRIBUTION BOARDS (MDBs):</strong>
                    </div>
                    <table class="item-table">
                        <thead>
                            <tr>
                                <th class="no-col">No</th>
                                <th class="desc-col">MAIN DISTRIBUTION BOARD (MDB's)</th>
                                <th class="qty-col">Qty</th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-set="mdb_counter" t-value="1"/>
                            <t t-set="mdb_products" t-value="doc.get_mdb_products()"/>
                            <t t-set="total_components" t-value="0"/>

                            <t t-foreach="mdb_products" t-as="mdb">
                                <!-- MDB Product Row -->

                                <tr class="mdb-product-row">
                                    <td class="no-col">
                                        <t t-esc="mdb_counter"/>
                                    </td>
                                    <td class="desc-col">
                                        <span class="product-name">
                                            <t t-esc="mdb['product'].name"/>
                                        </span>
                                        <t t-if="mdb['product'].description_sale">
                                            <span class="product-description">
                                                <t t-esc="mdb['product'].description_sale"/>
                                            </span>
                                        </t>
                                    </td>
                                    <td class="qty-col">
                                        <t t-esc="mdb['qty']"/>
                                    </td>
                                </tr>
                                <!--                                <tr>-->
                                <!--                                    <td class="no-col">-->
                                <!--                                        <t t-esc="mdb_counter"/>-->
                                <!--                                    </td>-->
                                <!--                                    <td class="desc-col">-->
                                <!--                                        <t t-esc="mdb['product'].name"/>-->
                                <!--                                    </td>-->
                                <!--                                    <td class="qty-col">-->
                                <!--                                        <t t-esc="mdb['qty']"/>-->
                                <!--                                    </td>-->
                                <!--                                </tr>-->


                                <!-- BOM Components Section -->
                                <t t-set="components_by_category"
                                   t-value="doc.get_bom_components_by_category(mdb['product'], mdb['qty'])"/>
                                <t t-if="components_by_category">
                                    <t t-foreach="components_by_category.items()" t-as="category">
                                        <!-- Category Header -->
                                        <tr>
                                            <td class="no-col"></td>
                                            <td class="h6 desc-col component-section">
                                                <t t-esc="category[0]"/>
                                            </td>
                                            <td class="qty-col"></td>
                                        </tr>

                                        <!-- Components -->
                                        <t t-foreach="category[1]" t-as="component">
                                            <tr>
                                                <td class="no-col"></td>
                                                <td class="desc-col component-indent">
                                                    <t t-if="component['product']" t-esc="component['product'].name"/>
                                                    <t t-else="" t-esc="component['name']"/>
                                                </td>
                                                <!--                                                <td class="desc-col component-indent">-->
                                                <!--                                                    <t t-esc="component['name']"/>-->
                                                <!--                                                </td>-->
                                                <td class="qty-col">
                                                    <t t-esc="int(component['qty']) if component['qty'] == int(component['qty']) else '%.1f' % component['qty']"/>
                                                </td>
                                            </tr>
                                        </t>
                                    </t>
                                </t>
                                <t t-set="mdb_counter" t-value="mdb_counter + 1"/>
                            </t>

                            <!-- Total Row -->
                            <tr class="total-row">
                                <td class="no-col"></td>
                                <td class="desc-col">TOTAL PRODUCTS</td>
                                <td class="qty-col">
                                    <t t-esc="sum(line.product_uom_qty for line in doc.order_line)"/>
                                </td>
                            </tr>

                            <tr t-if="not mdb_products">
                                <td colspan="3">No Main Distribution Boards found in this order.</td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- PRODUCTS TABLE SECTION -->
                    <div class="page-break"></div>

                    <div class="section-margin">
                        <strong>PRODUCTS LIST:</strong>
                    </div>
                    <table class="capacitor-table">
                        <thead>
                            <tr>
                                <th class="no-col">No</th>
                                <th class="desc-col">PRODUCT DESCRIPTION</th>
                                <th class="qty-col">Qty</th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-set="product_counter" t-value="1"/>
                            <t t-set="total_qty" t-value="0"/>
                            <t t-foreach="doc.order_line" t-as="line">
                                <tr t-if="line.product_id and not line.display_type" class="product-row">
                                    <td class="no-col">
                                        <t t-esc="product_counter"/>
                                    </td>
                                    <td class="desc-col">
                                        <t t-esc="line.product_id.name"/>
                                    </td>
                                    <td class="qty-col">
                                        <t t-esc="int(line.product_uom_qty) if line.product_uom_qty == int(line.product_uom_qty) else '%.1f' % line.product_uom_qty"/>
                                    </td>
                                </tr>
                                <t t-if="line.product_id and not line.display_type">
                                    <t t-set="product_counter" t-value="product_counter + 1"/>
                                    <t t-set="total_qty" t-value="total_qty + line.product_uom_qty"/>
                                </t>
                            </t>
                            <tr class="total-row">
                                <td colspan="2" class="total-label">TOTAL</td>
                                <td class="qty-col">
                                    <t t-esc="int(total_qty) if total_qty == int(total_qty) else '%.1f' % total_qty"/>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </t>
            </t>
        </t>
    </template>
</odoo>
